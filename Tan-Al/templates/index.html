<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmonisation</title>
    <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>
<!-- ImportMap pour charger les modules depuis CDN -->
<script type="importmap">
    {
      "imports": {
        "three": "https://cdn.skypack.dev/three@0.152.0/build/three.module",
        "three/": "https://cdn.skypack.dev/three@0.152.0/",
        "stats": "https://cdnjs.cloudflare.com/ajax/libs/stats.js/r17/Stats.min.js",
        "socket.io": "https://cdn.socket.io/4.8.1/socket.io.esm.min.js",
        "jszip": "https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm"
      }
    }
</script>

<div class="container">
    <div class="settings">
        <h3>Charger votre Image</h3>
        <div class="drag-area" id="drag-area">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" fill="currentColor">
                <path d="M160 32c-35.3 0-64 28.7-64 64l0 224c0 35.3 28.7 64 64 64l352 0c35.3 0 64-28.7 64-64l0-224c0-35.3-28.7-64-64-64L160 32zM396 138.7l96 144c4.9 7.4 5.4 16.8 1.2 24.6S480.9 320 472 320l-144 0-48 0-80 0c-9.2 0-17.6-5.3-21.6-13.6s-2.9-18.2 2.9-25.4l64-80c4.6-5.7 11.4-9 18.7-9s14.2 3.3 18.7 9l17.3 21.6 56-84C360.5 132 368 128 376 128s15.5 4 20 10.7zM192 128a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zM48 120c0-13.3-10.7-24-24-24S0 106.7 0 120L0 344c0 75.1 60.9 136 136 136l320 0c13.3 0 24-10.7 24-24s-10.7-24-24-24l-320 0c-48.6 0-88-39.4-88-88l0-224z"/>
            </svg>
            <span class="header">Drag & drop pour <span class="primary">Charger</span> une Image</span>
            <span class="support">Formats supportés: jpg, jpeg, png, webp</span>
        </div>
        <input type="file" id="upload" accept="image/*" style="display: none;">

        <h3 class="hidden" id="previews-title">Prévisualisation</h3>
        <div class="hidden previews-container" id="previews-container">
            <img id="original-image" class="hidden" alt="Image originale" src="">
            <canvas id="harmonized-image" class="hidden"></canvas>
        </div>

        <h3 class="hidden" id="palettes-title">Palettes avant et après simplification</h3>
        <div class="palettes-container" id="palettes-container">
            <div class="hidden" id="initial-palette">
                <!-- La palette de couleurs initiale apparaîtra ici -->
            </div>
            <div class="hidden" id="simplified-palette">
                <!-- La palette de couleurs simplifiée apparaîtra ici -->
            </div>
            <div class="palettes-actions">
                <div class="hidden" id="rollback-palette">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor">
                        <path d="M480 256c0 123.4-100.5 223.9-223.9 223.9c-48.86 0-95.19-15.58-134.2-44.86c-14.14-10.59-17-30.66-6.391-44.81c10.61-14.09 30.69-16.97 44.8-6.375c27.84 20.91 61 31.94 95.89 31.94C344.3 415.8 416 344.1 416 256s-71.67-159.8-159.8-159.8C205.9 96.22 158.6 120.3 128.6 160H192c17.67 0 32 14.31 32 32S209.7 224 192 224H48c-17.67 0-32-14.31-32-32V48c0-17.69 14.33-32 32-32s32 14.31 32 32v70.23C122.1 64.58 186.1 32.11 256.1 32.11C379.5 32.11 480 132.6 480 256z"/>
                    </svg>
                </div>
                <div class="hidden" id="download-palettes">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor">
                        <path d="M448 416v-64c0-17.67-14.33-32-32-32s-32 14.33-32 32v64c0 17.67-14.33 32-32 32H96c-17.67 0-32-14.33-32-32v-64c0-17.67-14.33-32-32-32s-32 14.33-32 32v64c0 53.02 42.98 96 96 96h256C405 512 448 469 448 416zM246.6 342.6l128-128c12.51-12.51 12.49-32.76 0-45.25c-12.5-12.5-32.75-12.5-45.25 0L256 242.8V32c0-17.69-14.31-32-32-32S192 14.31 192 32v210.8L118.6 169.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25l128 128C213.9 355.1 234.1 355.1 246.6 342.6z"/>
                    </svg>
                </div>
            </div>
        </div>

        <h3 class="hidden" id="layers-title">Image décomposée</h3>
        <div class="layers-container hidden" id="layers-container">
            <!-- Les différentes couches de l'image -->
            <div class="hidden" id="download-layers">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor">
                    <path d="M448 416v-64c0-17.67-14.33-32-32-32s-32 14.33-32 32v64c0 17.67-14.33 32-32 32H96c-17.67 0-32-14.33-32-32v-64c0-17.67-14.33-32-32-32s-32 14.33-32 32v64c0 53.02 42.98 96 96 96h256C405 512 448 469 448 416zM246.6 342.6l128-128c12.51-12.51 12.49-32.76 0-45.25c-12.5-12.5-32.75-12.5-45.25 0L256 242.8V32c0-17.69-14.31-32-32-32S192 14.31 192 32v210.8L118.6 169.4c-12.5-12.5-32.75-12.5-45.25 0s-12.5 32.75 0 45.25l128 128C213.9 355.1 234.1 355.1 246.6 342.6z"/>
                </svg>
            </div>
        </div>
    </div>
    <div class="content">
        <div id="webgl-output"></div>
        <div id="terminal-container" class="terminal-container">
            <div id="terminal">
                <!-- Les messages de la console apparaîtront ici -->
            </div>
        </div>
        <div id="terminal-slider"></div>
    </div>
    <div class="harmonize">
        <button id="harmonize" class="">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor">
                <path d="M324.4 103.1L384 128l24.88 59.63C410.2 190.3 413 192 416 192s5.75-1.75 7.125-4.375L448 128l59.63-24.88C510.3 101.8 512 99 512 96s-1.75-5.75-4.375-7.125L448 64l-24.88-59.62C421.8 1.75 419 0 416 0s-5.75 1.75-7.125 4.375L384 64l-59.63 24.88C321.8 90.25 320 93 320 96S321.8 101.8 324.4 103.1zM507.6 408.9L448 384l-24.88-59.63C421.8 321.8 419 320 416 320s-5.75 1.75-7.125 4.375L384 384l-59.63 24.88C321.8 410.2 320 413 320 416s1.75 5.75 4.375 7.125L384 448l24.88 59.63C410.2 510.2 413 512 416 512s5.75-1.75 7.125-4.375L448 448l59.63-24.88C510.3 421.8 512 419 512 416S510.3 410.2 507.6 408.9zM384 255.6c0-6-3.375-11.62-8.875-14.38l-112.5-56.31L206.3 72.19c-5.375-10.88-23.13-10.88-28.5 0L121.4 184.9L8.875 241.2C3.375 244 0 249.6 0 255.6c0 6.125 3.375 11.62 8.875 14.38l112.5 56.37l56.38 112.7C180.4 444.4 185.1 447.9 192 447.9c5.999 0 11.62-3.512 14.25-8.887l56.38-112.7l112.5-56.37C380.6 267.2 384 261.8 384 255.6z"/>
            </svg>
        </button>
    </div>
</div>
<script type="module" src="../static/js/main.js"></script>
</body>
</html>
